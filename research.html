<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Verifica√ß√£o ZOH Token</title>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #connectBtn { padding: 10px 20px; font-size: 16px; }
        #status { margin-top: 20px; white-space: pre-line; }
    </style>
</head>
<body>
    <h2>üîç Verifica√ß√£o de Token ZOH</h2>
    <button id="connectBtn">Conectar Phantom Wallet</button>
    <div id="status">Carteira n√£o conectada.</div>
    <div id="researchContent" style="display: none; margin-top: 20px;">
        <h3>üéâ Acesso concedido √† √°rea de pesquisa!</h3>
        <p>Conte√∫do reservado para holders de ZOH.</p>
    </div>

    <script>
        const TOKEN_ADDRESS = "22qVsVm2dyFg5WC72hQTdh92GgFqwboAQ7TMAHhfpump";
        const connectBtn = document.getElementById("connectBtn");
        const status = document.getElementById("status");
        const researchContent = document.getElementById("researchContent");

        connectBtn.addEventListener("click", async () => {
            status.textContent = "üïê Conectando...";
            if (window.solana && window.solana.isPhantom) {
                try {
                    const resp = await window.solana.connect();
                    const publicKey = resp.publicKey;
                    const walletAddress = publicKey.toString();
                    status.textContent = `Carteira conectada: ${walletAddress}\nüîç Buscando tokens ZOH...`;

                    const connection = new solanaWeb3.Connection(
                        solanaWeb3.clusterApiUrl("mainnet-beta"),
                        "confirmed"
                    );

                    const tokenAccounts = await connection.getParsedTokenAccountsByOwner(
                        publicKey,
                        {
                            programId: new solanaWeb3.PublicKey(
                                "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"
                            )
                        }
                    );

                    console.log("Contas encontradas:", tokenAccounts.value);

                    const hasZOH = tokenAccounts.value.some(account => {
                        const info = account.account.data.parsed.info;
                        console.log("Token encontrado:", info.mint, "Quantidade:", info.tokenAmount.uiAmount);
                        return (
                            info.mint === TOKEN_ADDRESS &&
                            parseFloat(info.tokenAmount.uiAmount) > 0
                        );
                    });

                    if (hasZOH) {
                        status.textContent += "\n‚úÖ Token ZOH encontrado! Acesso liberado.";
                        researchContent.style.display = "block";
                    } else {
                        status.textContent += "\n‚õî Voc√™ n√£o possui ZOH nesta carteira.";
                        researchContent.style.display = "none";
                    }

                } catch (err) {
                    console.error("Erro ao conectar:", err);
                    status.textContent = "‚ùå Erro ao conectar com a carteira. Verifique se a Phantom est√° logada.";
                }
            } else {
                status.textContent = "‚ö†Ô∏è Phantom Wallet n√£o detectada. Instale em https://phantom.app";
            }
        });
    </script>
</body>
</html>
